<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario EgitoNCRP - Oficial</title>
    <style>
        :root { 
            --cor-primaria: #c5a059; 
            --cor-erro: #f04747; 
            --cor-sucesso: #43b581; 
            --cor-fundo-card: rgba(15, 15, 15, 0.96); 
        }

        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), url('https://i.imgur.com/8QzXyFp.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            overflow-x: hidden;
        }

        .container { 
            background: var(--cor-fundo-card); 
            padding: 35px; 
            border-radius: 15px; 
            border: 2px solid var(--cor-primaria); 
            box-shadow: 0 0 30px rgba(197, 160, 89, 0.2); 
            width: 480px; 
            text-align: center; 
            backdrop-filter: blur(10px); 
            position: relative;
        }

        h2 { color: var(--cor-primaria); text-transform: uppercase; letter-spacing: 3px; margin: 10px 0; }
        
        .campo-foto {
            background: rgba(197, 160, 89, 0.05);
            border: 1px dashed var(--cor-primaria);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.3s;
        }

        input[type="text"], input[type="number"], input[type="password"] { 
            width: 100%; 
            padding: 12px; 
            margin: 8px 0; 
            border-radius: 6px; 
            border: 1px solid #333; 
            background: rgba(45, 45, 45, 0.9); 
            color: white; 
            box-sizing: border-box; 
            outline: none;
        }

        button { 
            width: 100%; 
            padding: 15px; 
            background: var(--cor-primaria); 
            border: none; 
            color: #000; 
            font-weight: bold; 
            text-transform: uppercase;
            cursor: pointer; 
            border-radius: 6px; 
            transition: 0.4s; 
            margin-top: 15px; 
        }

        button:hover { background: #fff; transform: translateY(-2px); }

        #timer { font-size: 40px; color: var(--cor-erro); font-weight: bold; margin-bottom: 10px; }
        .hidden { display: none; }
        .stats { display: flex; justify-content: space-around; margin-bottom: 20px; color: var(--cor-primaria); font-weight: bold; }
        
        #opcoes button {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #444;
            color: white;
            text-align: left;
            margin-top: 8px;
            text-transform: none;
            font-weight: normal;
        }

        #preview-img { width: 100%; max-height: 150px; object-fit: contain; margin-top: 10px; border-radius: 5px; display: none; border: 1px solid var(--cor-primaria); }

        /* Bot√£o e Aba de Admin */
        #btn-adm-trigger {
            position: fixed;
            bottom: 15px;
            right: 15px;
            background: none;
            border: none;
            color: rgba(255,255,255,0.2);
            cursor: pointer;
            font-size: 20px;
            width: auto;
            padding: 5px;
        }

        #btn-adm-trigger:hover { color: var(--cor-primaria); }

        .admin-box {
            border-top: 2px solid var(--cor-primaria);
            margin-top: 20px;
            padding-top: 20px;
            background: rgba(0,0,0,0.4);
            border-radius: 10px;
            padding: 15px;
        }

    </style>
</head>
<body>

<div id="tela-cadastro" class="container">
    <img src="formulario.jpg" alt="Logo" style="width: 90px; height: 90px; border-radius: 50%; border: 2px solid var(--cor-primaria); object-fit: cover;">
    <h2>Egitoncrp</h2>
    <p style="font-size: 0.8rem; opacity: 0.7; letter-spacing: 1px;">SISTEMA DE RECRUTAMENTO</p>
    
    <input type="text" id="discordID" placeholder="ID do Discord (Num√©rico)">
    <input type="text" id="nick" placeholder="Nome Completo In-game">
    <input type="number" id="passaporte" placeholder="ID / Passaporte">
    <input type="number" id="idade" placeholder="Idade (Vida Real)">
    <input type="text" id="tempo" placeholder="Tempo de RP (Ex: 1 ano)">

    <div class="campo-foto" onclick="document.getElementById('foto-esc').click()">
        <label class="upload-label" id="label-foto">üì∏ CLIQUE PARA ANEXAR PRINT DO ESC</label>
        <input type="file" id="foto-esc" accept="image/*" onchange="previewFile(event)">
        <img id="preview-img" src="" alt="Preview">
    </div>

    <button onclick="iniciarProcesso()">Iniciar Prova</button>
</div>

<div id="tela-quiz" class="container hidden">
    <div id="timer">30</div>
    <div class="stats">
        <span>Quest√£o: <span id="num-pergunta">1</span>/15</span>
        <span>Erros: <span id="cont-erros">0</span>/3</span>
    </div>
    <div class="pergunta-card">
        <h3 id="pergunta-texto">...</h3>
        <div id="opcoes"></div>
    </div>
</div>

<div id="tela-resultado" class="container hidden">
    <h1 id="titulo-final">Processando...</h1>
    <p id="subtitulo-final">Enviando seus dados para a Tropa do Egito...</p>
    <button onclick="window.location.reload()">Sair do Sistema</button>
</div>

<div id="tela-admin" class="container hidden">
    <h2>Configura√ß√µes ADM</h2>
    <p>Ajuste o link de recebimento dos dados:</p>
    <input type="password" id="webhook-input" placeholder="Cole aqui o link do Webhook do Discord">
    <button onclick="salvarConfig()">Salvar e Voltar</button>
    <button style="background: #333; color: white;" onclick="fecharAdmin()">Cancelar</button>
</div>

<button id="btn-adm-trigger" onclick="abrirAdmin()" title="Configura√ß√µes">‚öôÔ∏è</button>

<script>
    // Carrega o webhook do armazenamento do navegador ou usa o padr√£o
    let config = {
        webhook: localStorage.getItem('egito_webhook') || "INSIRA_SEU_WEBHOOK",
        errosParaReprovar: 3,
        tempoPorPergunta: 30,
        senhaAdm: "egito123" // SENHA PARA ACESSAR A ABA ADM
    };

    const perguntas = [
        { q: "O que √© VDM?", options: ["Matar com armas de fogo", "Atropelar propositalmente sem motivo de RP", "Bater o carro sem querer"], correct: 1 },
        { q: "O que √© RDM?", options: ["Matar algu√©m sem motivo focado no RP", "Roubar um banco", "Correr da pol√≠cia"], correct: 0 },
        { q: "O que √© MetaGaming?", options: ["Fazer live", "Usar informa√ß√µes de fora do jogo (Discord) no RP", "Falar no r√°dio"], correct: 1 },
        { q: "O que √© PowerGaming?", options: ["Fazer a√ß√µes imposs√≠veis na vida real", "Ser o dono da cidade", "Comprar carros caros"], correct: 0 },
        { q: "O que √© Fear RP?", options: ["N√£o ter medo de nada", "Valorizar a vida do personagem como se fosse a sua", "Ter medo de altura"], correct: 1 },
        { q: "O que √© Combat Logging?", options: ["Quitar/Sair do jogo durante uma a√ß√£o ou abordagem", "Entrar em combate", "Trocar de personagem"], correct: 0 },
        { q: "Pode reconhecer algu√©m mascarado?", options: ["Sim, pela voz ou ID", "N√£o, √© proibido se ele estiver devidamente mascarado", "Apenas se ele for seu amigo"], correct: 1 },
        { q: "O que √© Safe Zone?", options: ["√Årea de tiro liberado", "√Årea onde crimes e agress√µes s√£o proibidos", "Sede da Tropa"], correct: 1 },
        { q: "O que significa OOC?", options: ["Out of Character (Assuntos da Vida Real)", "Only On Chat", "Organiza√ß√£o Criminosa"], correct: 0 },
        { q: "O que significa IC?", options: ["In Character (Tudo dentro do personagem)", "I am Cop", "Informa√ß√£o Comum"], correct: 0 },
        { q: "O que √© Revenge Kill?", options: ["Matar algu√©m por vingan√ßa ap√≥s voc√™ morrer na a√ß√£o", "Vingar a morte de um aliado", "Matar um policial"], correct: 0 },
        { q: "Rendido por 2 pessoas armadas, o que voc√™ faz?", options: ["Tento reagir r√°pido", "Levanto as m√£os e sigo as ordens (Fear RP)", "Saio correndo"], correct: 1 },
        { q: "O que √© Flood?", options: ["Nadar", "Repetir mensagens seguidas no chat", "Usar r√°dio"], correct: 1 },
        { q: "Pode reviver com 'E' no meio de uma troca de tiros?", options: ["Sim", "N√£o, deve esperar a a√ß√£o acabar totalmente", "Apenas se n√£o tiver m√©dicos"], correct: 1 },
        { q: "O que √© Car Jacking?", options: ["Roubar um carro sem motivo de RP apenas para zoar", "Pintar o carro", "Trancar o carro"], correct: 0 }
    ];

    let indiceAtual = 0, erros = 0, tempoRestante = config.tempoPorPergunta, intervalo;
    let dadosCandidato = {}, historico = [], fotoArquivo = null;

    // --- FUN√á√ïES DE ADMIN ---
    function abrirAdmin() {
        let senha = prompt("Digite a senha de administrador:");
        if (senha === config.senhaAdm) {
            document.getElementById('tela-cadastro').classList.add('hidden');
            document.getElementById('tela-admin').classList.remove('hidden');
            document.getElementById('webhook-input').value = config.webhook;
        } else {
            alert("Senha incorreta!");
        }
    }

    function fecharAdmin() {
        document.getElementById('tela-admin').classList.add('hidden');
        document.getElementById('tela-cadastro').classList.remove('hidden');
    }

    function salvarConfig() {
        const novoWebhook = document.getElementById('webhook-input').value;
        if (novoWebhook.startsWith("https://discord.com/api/webhooks/")) {
            config.webhook = novoWebhook;
            localStorage.setItem('egito_webhook', novoWebhook);
            alert("Configura√ß√µes salvas com sucesso!");
            fecharAdmin();
        } else {
            alert("Por favor, insira um link de Webhook v√°lido do Discord!");
        }
    }

    // --- L√ìGICA DO FORMUL√ÅRIO ---
    function previewFile(event) {
        fotoArquivo = event.target.files[0];
        const preview = document.getElementById('preview-img');
        const label = document.getElementById('label-foto');
        if (fotoArquivo) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.style.display = "block";
                label.innerText = "‚úÖ PRINT SELECIONADO";
            }
            reader.readAsDataURL(fotoArquivo);
        }
    }

    function iniciarProcesso() {
        if (config.webhook === "INSIRA_SEU_WEBHOOK") {
            return alert("ERRO: O Webhook n√£o foi configurado pelo Administrador!");
        }
        dadosCandidato = {
            discord: document.getElementById('discordID').value,
            nick: document.getElementById('nick').value,
            pass: document.getElementById('passaporte').value,
            idade: document.getElementById('idade').value,
            tempo: document.getElementById('tempo').value
        };
        if (!dadosCandidato.discord || !dadosCandidato.nick || !fotoArquivo) {
            return alert("ERRO: Preencha todos os dados e anexe o Print do ESC!");
        }
        document.getElementById('tela-cadastro').classList.add('hidden');
        document.getElementById('tela-quiz').classList.remove('hidden');
        mostrarPergunta();
    }

    function mostrarPergunta() {
        if (indiceAtual >= perguntas.length) return finalizar(true);
        document.getElementById('num-pergunta').innerText = indiceAtual + 1;
        clearInterval(intervalo);
        tempoRestante = config.tempoPorPergunta;
        document.getElementById('timer').innerText = tempoRestante;

        const p = perguntas[indiceAtual];
        document.getElementById('pergunta-texto').innerText = p.q;
        const btnContainer = document.getElementById('opcoes');
        btnContainer.innerHTML = "";

        p.options.forEach((opt, i) => {
            const b = document.createElement('button');
            b.innerText = opt;
            b.onclick = () => {
                if (i !== p.correct) {
                    historico.push(`‚ùå ${p.q}`);
                    erros++;
                    document.getElementById('cont-erros').innerText = erros;
                    if (erros >= config.errosParaReprovar) return finalizar(false);
                } else {
                    historico.push(`‚úÖ ${p.q}`);
                }
                indiceAtual++;
                mostrarPergunta();
            };
            btnContainer.appendChild(b);
        });

        intervalo = setInterval(() => {
            tempoRestante--;
            document.getElementById('timer').innerText = tempoRestante;
            if (tempoRestante <= 0) {
                historico.push(`‚è∞ ${p.q} (Esgotado)`);
                erros++;
                if (erros >= config.errosParaReprovar) finalizar(false);
                else { indiceAtual++; mostrarPergunta(); }
            }
        }, 1000);
    }

    function finalizar(passou) {
        clearInterval(intervalo);
        document.getElementById('tela-quiz').classList.add('hidden');
        document.getElementById('tela-resultado').classList.remove('hidden');
        const status = passou ? "APROVADO" : "REPROVADO";
        document.getElementById('titulo-final').innerText = passou ? "‚úÖ ENVIADO" : "‚ùå REPROVADO";
        enviarParaDiscord(status);
    }

    async function enviarParaDiscord(status) {
        const formData = new FormData();
        formData.append('file', fotoArquivo, 'print_esc.png');
        const embed = {
            title: "üá™üá¨ NOVO RECRUTAMENTO - TROPA DO EGITO üî±",
            description: `**RELAT√ìRIO DE QUEST√ïES:**\n${historico.join('\n')}`,
            color: status === "APROVADO" ? 4437377 : 15749431,
            fields: [
                { name: "üë§ Candidato", value: `**Nick:** ${dadosCandidato.nick}\n**Passaporte:** ${dadosCandidato.pass}\n**Discord:** <@${dadosCandidato.discord}>`, inline: true },
                { name: "üìã Info IC/OOC", value: `**Idade:** ${dadosCandidato.idade}\n**Exp:** ${dadosCandidato.tempo}`, inline: true },
                { name: "üìä Resultado", value: `**Status:** \`${status}\`\n**Erros:** ${erros}/3`, inline: false }
            ],
            image: { url: 'attachment://print_esc.png' },
            footer: { text: "EgitoNCRP ‚Ä¢ Sistema de Verifica√ß√£o" },
            timestamp: new Date()
        };
        formData.append('payload_json', JSON.stringify({ embeds: [embed] }));
        try {
            await fetch(config.webhook, { method: 'POST', body: formData });
        } catch (e) {
            console.error("Erro ao enviar para o Discord");
        }
    }
</script>
</body>
</html>